<Page
  x:Class="Tiny_GymBook.Presentation.SecondPage"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:models="using:Tiny_GymBook.Models"
  xmlns:utu="using:Uno.Toolkit.UI"
  mc:Ignorable="d"
  x:Name="SecondPageRoot"
  Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

  <Grid Padding="12"
        RowSpacing="12">

    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <!-- Header -->
      <RowDefinition Height="*"/>
      <!-- List -->
      <RowDefinition Height="Auto"/>
      <!-- Add button -->
      <RowDefinition Height="Auto"/>
      <!-- TabBar -->
    </Grid.RowDefinitions>

    <!-- Titel -->
    <TextBlock Text="Trainingspläne"
               FontSize="24"
               FontWeight="Bold"
               HorizontalAlignment="Center"
               Foreground="DodgerBlue"
               Margin="0,0,0,8"/>

    <TextBlock Grid.Row="0"
               Text="{Binding Trainingsplaene.Count}"
               FontSize="18"/>

    <!-- Liste der Pläne -->
    <ListView Grid.Row="1"
              ItemsSource="{Binding Trainingsplaene}"
              SelectedItem="{Binding SelectedPlan, Mode=TwoWay}"
              SelectionMode="None"
              Margin="0,8">
      <ListView.ItemTemplate>
        <DataTemplate x:DataType="models:Trainingsplan">
          <Grid Padding="8"
                BorderBrush="Black"
                BorderThickness="1"
                Margin="0,4">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*"/>
              <ColumnDefinition Width="Auto"/>
              <!-- Für Detailansicht -->
              <ColumnDefinition Width="Auto"/>
              <!-- Für Löschen -->
            </Grid.ColumnDefinitions>

            <TextBlock Text="{x:Bind Name}"
                       FontSize="16"
                       VerticalAlignment="Center"/>
            <Button Content=">"
                    Click="DebugClick"
                    Command="{Binding DataContext.OpenPlanCommand, ElementName=SecondPageRoot}"
                    CommandParameter="{x:Bind}"
                    Grid.Column="1"
                    Margin="12,0,0,0"
                    VerticalAlignment="Center"/>

            <Button Content="🗑"
                    Command="{Binding DataContext.DeletePlanCommand, ElementName=SecondPageRoot}"
                    CommandParameter="{Binding}"
                    Grid.Column="2"
                    Margin="12,0,0,0"
                    VerticalAlignment="Center"
                    Foreground="Red"/>


          </Grid>
        </DataTemplate>
      </ListView.ItemTemplate>
    </ListView>

    <!-- Hinzufügen-Button -->
    <Button Grid.Row="2"
            Content="Trainingsplan hinzufügen"
            Command="{Binding AddPlanCommand}"
            Margin="0,12"
            HorizontalAlignment="Center"/>


    <!-- TabBar -->
    <utu:TabBar Grid.Row="3"
                Style="{StaticResource BottomTabBarStyle}">
      <utu:TabBar.Items>
        <utu:TabBarItem Content="HOME"
                        Command="{Binding NavigateToHomeCommand}">
          <utu:TabBarItem.Icon>
            <FontIcon Glyph="{StaticResource HomeIcon}"/>
          </utu:TabBarItem.Icon>
        </utu:TabBarItem>
        <utu:TabBarItem Content="Pläne"
                        IsSelected="True">
          <utu:TabBarItem.Icon>
            <FontIcon Glyph="{StaticResource SupportIcon}"/>
          </utu:TabBarItem.Icon>
        </utu:TabBarItem>

      </utu:TabBar.Items>
    </utu:TabBar>

  </Grid>
</Page>
